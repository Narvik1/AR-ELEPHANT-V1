<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <title>AR Anatomi Gajah</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />

  <!-- A-Frame Core -->
  <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>

  <!-- A-Frame WebXR Hit-Test Component (Wajib untuk Tap-to-Place) -->
  <script src="https://cdn.jsdelivr.net/npm/aframe-hit-test-component@1.0.0/dist/aframe-hit-test-component.min.js"></script>

  <style>
    /* Canvas behind UI */
    a-scene, a-scene canvas {
      position: fixed !important;
      inset: 0 !important;
      width: 100% !important;
      height: 100% !important;
      background: transparent !important;
      z-index: 0;
    }

    :root{
      --accent:#9ED2A1;
      --accent-dark:#2fae6e;
      --panel-bg: rgba(255,255,255,0.95);
      --shadow: 0 6px 18px rgba(0,0,0,0.12);
      font-family: Inter, system-ui;
    }
    body,html{margin:0;background:#eef7ef;}

    #ui-root{
      position:fixed; inset:0;
      display:flex; flex-direction:column; justify-content:space-between;
      pointer-events:none; z-index:10;
    }
    .panel{background:var(--panel-bg); padding:8px; border-radius:12px; box-shadow:var(--shadow); pointer-events:auto;}
    .btn{background:var(--accent);color:#fff;border:none;padding:8px 14px;border-radius:10px;font-weight:600;cursor:pointer;}
    .mode-btn{background:linear-gradient(180deg,var(--accent),var(--accent-dark));color:#fff;border:none;padding:8px 14px;border-radius:10px;font-weight:700;cursor:pointer;}
    .btn-ghost{background:transparent;border:1px solid #ccc;padding:8px 14px;border-radius:10px;cursor:pointer;}

    #tooltip{position:absolute;display:none;min-width:180px;max-width:300px;}
    #detailModal{position:absolute;display:none;left:50%;transform:translateX(-50%);bottom:20px;width:90%;max-width:340px;}
  </style>
</head>

<body>

<!-- UI Overlay -->
<div id="ui-root">
  <div style="padding:12px; display:flex; justify-content:space-between;">
    <div class="panel" style="display:flex; gap:8px;">
      <button id="btnBody" class="mode-btn">Tubuh</button>
      <button id="btnSkeleton" class="mode-btn">Tulang</button>
      <button id="btnOrgans" class="mode-btn">Organ</button>
    </div>
    <div class="panel">
      <button id="enterBtn" class="btn">Enter AR</button>
    </div>
  </div>

  <div id="tooltip" class="panel"></div>

  <div style="display:flex; justify-content:center; margin-bottom:20px;">
    <div id="placeBtn" class="panel" style="display:none;">
      <button id="placeModel" class="btn">Place Model</button>
    </div>
  </div>

  <div style="display:flex; justify-content:center; padding-bottom:20px;">
    <div id="controls" class="panel" style="display:none; display:flex; gap:12px;">
      <div>
        <div>Scale</div>
        <input id="scaleRange" type="range" min="0.3" max="2.0" step="0.01" value="1">
      </div>
      <div>
        <div>Rotate</div>
        <input id="rotateRange" type="range" min="0" max="360" step="1" value="0">
      </div>
      <button id="toggleSkeletonSmall" class="btn-ghost">Toggle Skeleton</button>
    </div>
  </div>
</div>

<div id="detailModal" class="panel"></div>

<!-- SCENE -->
<a-scene
  embedded
  renderer="logarithmicDepthBuffer: true;"
  vr-mode-ui="enabled: false"
  arjs="sourceType: webcam; debugUIEnabled: false;"
>
  <!-- Kamera AR.js -->
  <a-entity camera></a-entity>

  <!-- Marker -->
  <a-marker type="pattern" url="assets/markers/elephant_marker.patt">
 <a-marker type="pattern" url="assets/markers/elephant_marker.patt">
  <a-box position="0 0.5 0" material="color: red;"></a-box>
</a-marker>

    <!-- Root semua model -->
    <a-entity id="modelRoot" position="0 0 0" scale="0.5 0.5 0.5">

      <!-- Tubuh -->
      <a-entity id="layer_body" gltf-model="assets/models/gajah.glb" visible="true"></a-entity>

      <!-- Tulang -->
      <a-entity id="layer_skeleton" gltf-model="assets/models/tulang_gajah.glb" visible="false"></a-entity>

      <!-- Organ -->
      <a-entity id="layer_organs" visible="false">
        <a-entity id="organ_heart" gltf-model="assets/models/jantung.glb" position="0 0.4 0"></a-entity>
      </a-entity>

    </a-entity>

  </a-marker>

</a-scene>


<script src="src/app.js"></script>
</body>
</html>
